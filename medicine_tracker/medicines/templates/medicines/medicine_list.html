{% extends "base.html" %}
{% block content %}
  <h2>My Medicines</h2>
  <table class="table table-striped">
    <thead>
      <tr>
        <th>Medicine</th>
        <th>Dosage</th>
        <th>Remaining Doses</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for user_med in medicines %}
      <tr>
        <td>
          <details>
            <summary>
              <!-- NÃ¡zev lÃ©ku z modelu Medicine -->
              <strong>{{ user_med.medicine.name }}</strong>
            </summary>
            <div class="p-2">
              <small class="text-muted">
                <!-- DetailnÃ­ info z modelu UserMedicine -->
                <div>ğŸ“ PoznÃ¡mka: {{ user_med.notes|default:"Å½Ã¡dnÃ¡ poznÃ¡mka" }}</div>
                <div>ğŸ“… PoslednÃ­ uÅ¾itÃ­: {{ user_med.last_taken|default:"NezadÃ¡no" }}</div>
                <div>ğŸ—“ Den uÅ¾itÃ­: {{ user_med.day|default:"NezadÃ¡no" }}</div>
                <div>â° ÄŒas uÅ¾itÃ­: {{ user_med.time|default:"NezadÃ¡no" }}</div>

                <!-- DetailnÃ­ info z modelu Medicine -->
                <hr>
                <div>ğŸ­ VÃ½robce: {{ user_med.medicine.manufacturer|default:"Neuvedeno" }}</div>
                <div>ğŸŒ¡ Teplota skladovÃ¡nÃ­: {{ user_med.medicine.storage_temp|default:"Neuvedeno" }}</div>
                <div>âš ï¸ NeÅ¾Ã¡doucÃ­ ÃºÄinky: {{ user_med.medicine.side_effects|default:"Neuvedeno" }}</div>
              </small>
            </div>
          </details>
        </td>
        <td>{{ user_med.dosage }}</td>
        <td>{{ user_med.remaining_doses }}</td>
        <td>
          <a href="{% url 'take_dose' user_med.id %}" class="btn btn-success btn-sm">ğŸ’Š Take Dose</a>
          <a href="{% url 'edit_medicine' user_med.id %}" class="btn btn-warning btn-sm">âœ Edit</a>
          <a href="{% url 'delete_medicine' user_med.id %}" class="btn btn-danger btn-sm">ğŸ—‘ Delete</a>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  <a href="{% url 'add_medicine' %}" class="btn btn-primary mt-3">â• Add Medicine</a>

  <div class="mt-3 d-flex gap-2">
    <details>
      <summary class="btn btn-info">ğŸ“– Historie uÅ¾Ã­vÃ¡nÃ­ lÃ©kÅ¯</summary>
      <div class="mt-3">
        <h3 class="mt-4">ğŸ•˜ Historie uÅ¾Ã­vÃ¡nÃ­ lÃ©kÅ¯</h3>
        <table class="table table-bordered">
          <thead>
            <tr>
              <th>LÃ©k</th>
              <th>Datum uÅ¾itÃ­</th>
            </tr>
          </thead>
          <tbody>
            {% for entry in history %}
            <tr>
              <td>{{ entry.user_medicine.medicine.name }}</td>
              <td>{{ entry.date|date:"d.m.Y H:i" }}</td>
            </tr>
            {% empty %}
            <tr>
              <td colspan="2">ğŸ“­ Å½Ã¡dnÃ¡ historie nenÃ­ k dispozici.</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </details>


  </div>
{% endblock %}
